{
  "$schema": "./tasks.schema.json",
  "meta": {
    "version": "2.1.0",
    "last_updated": "2026-01-17T19:00:00Z",
    "last_agent": "Antigravity",
    "project_phase": "Phase 2 Graph RAG: Complete | Phase E: Data Completeness & Hosting"
  },
  "tasks": [
    {
      "id": "TASK-001",
      "title": "Citation Parser Implementation",
      "status": "completed",
      "priority": "high",
      "category": "feature",
      "created": "2026-01-10",
      "updated": "2026-01-15",
      "assigned_agent": "Discovery-Agent",
      "requires_review": false,
      "reviewed_by": "Antigravity",
      "review_notes": "Implemented in src/parser/citation_extractor.py. Tested with diverse PDFs.",
      "description": "Develop a module to find references like 'BNBest-P' or '§ 44 BHO' in text.",
      "acceptance_criteria": [
        "Regex-based extraction of laws and guidelines",
        "NER support for non-standardized references",
        "Integration into the parsing pipeline"
      ],
      "subtasks": [],
      "blocked_by": [],
      "blocks": [
        "TASK-002"
      ],
      "docs_updated": true,
      "verified": true,
      "verified_by": "opencode",
      "verified_date": "2026-01-17"
    },
    {
      "id": "TASK-002",
      "title": "Reference Linking",
      "status": "completed",
      "priority": "high",
      "category": "feature",
      "created": "2026-01-10",
      "updated": "2026-01-15",
      "assigned_agent": "Graph-Architekt",
      "requires_review": false,
      "reviewed_by": "Antigravity",
      "review_notes": "Edges are correctly created in knowledge_graph.json.",
      "description": "Generate REFERENCES edges between document nodes based on citations.",
      "acceptance_criteria": [
        "Automatic edge creation in NetworkX",
        "Stub-node creation for non-existing documents",
        "Visualization in Dashboard"
      ],
      "subtasks": [],
      "blocked_by": [
        "TASK-001"
      ],
      "blocks": [
        "TASK-003"
      ],
      "docs_updated": true,
      "verified": true,
      "verified_by": "opencode",
      "verified_date": "2026-01-17"
    },
    {
      "id": "TASK-003",
      "title": "Multi-Hop Retrieval",
      "status": "completed",
      "priority": "high",
      "category": "feature",
      "created": "2026-01-15",
      "updated": "2026-01-17",
      "assigned_agent": "opencode",
      "requires_review": true,
      "reviewed_by": null,
      "review_notes": "Logic implemented in src/parser/hybrid_search.py. Needs validation by next agent.",
      "description": "Implement logic to load neighboring nodes in RAG context via REFERENCES and SUPERSEDES edges.",
      "acceptance_criteria": [
        "Graph traversal in HybridSearchEngine",
        "Context injection for LLM",
        "Handling of SUPERSEDES for version warnings"
      ],
      "subtasks": [],
      "blocked_by": [
        "TASK-002"
      ],
      "blocks": [],
      "docs_updated": true,
      "verified": true,
      "verified_by": "opencode",
      "verified_date": "2026-01-17"
    },
    {
      "id": "TASK-004",
      "title": "Dashboard UI Filter Fixes",
      "status": "completed",
      "priority": "medium",
      "category": "bugfix",
      "created": "2026-01-15",
      "updated": "2026-01-16",
      "assigned_agent": "Antigravity",
      "requires_review": false,
      "reviewed_by": "opencode",
      "review_notes": "Filters for ministry and type are now functional.",
      "description": "Repair inactive UI filters in dashboard.html.",
      "acceptance_criteria": [
        "Ministry filter works",
        "Type filter works",
        "Reset button functional"
      ],
      "subtasks": [],
      "blocked_by": [],
      "blocks": [],
      "docs_updated": true,
      "verified": true,
      "verified_by": "opencode",
      "verified_date": "2026-01-17"
    },
    {
      "id": "TASK-005",
      "title": "Dockerization",
      "status": "completed",
      "priority": "medium",
      "category": "infrastructure",
      "created": "2026-01-17",
      "updated": "2026-01-17",
      "assigned_agent": "Antigravity",
      "requires_review": false,
      "reviewed_by": null,
      "review_notes": "Dockerfile and docker-compose.yml created. Backend and Frontend separated.",
      "description": "Create Dockerfiles for Backend and Frontend components.",
      "acceptance_criteria": [
        "Docker-compose for local development",
        "Optimized image size",
        "Persistence for ChromaDB"
      ],
      "subtasks": [],
      "blocked_by": [],
      "blocks": [],
      "docs_updated": true,
      "verified": true,
      "verified_by": "Antigravity",
      "verified_date": "2026-01-17"
    },
    {
      "id": "TASK-006",
      "title": "Full E2E Test Suite",
      "status": "completed",
      "priority": "high",
      "category": "testing",
      "created": "2026-01-17",
      "updated": "2026-01-17",
      "assigned_agent": "Antigravity",
      "requires_review": false,
      "reviewed_by": null,
      "review_notes": "Playwright E2E test covering search, AI answer, and graph context expansion.",
      "description": "Comprehensive E2E tests for the dashboard and search API.",
      "acceptance_criteria": [
        "Playwright coverage for all UI elements",
        "API response validation",
        "Data consistency checks"
      ],
      "subtasks": [],
      "blocked_by": [],
      "blocks": [],
      "docs_updated": true,
      "verified": true,
      "verified_by": "Antigravity",
      "verified_date": "2026-01-17"
    },
    {
      "id": "TASK-007",
      "title": "Full Crawler Implementation",
      "status": "pending",
      "priority": "high",
      "category": "feature",
      "created": "2026-01-17",
      "updated": "2026-01-17",
      "assigned_agent": "pending",
      "requires_review": false,
      "reviewed_by": null,
      "review_notes": null,
      "description": "Expand Easy-Online crawler to fetch all available documents from all ministries.",
      "acceptance_criteria": [
        "Recursive crawling of all ministry sub-pages",
        "Handling of rate limits and retries",
        "Complete manifest.json generation for the full corpus"
      ],
      "subtasks": [],
      "blocked_by": [],
      "blocks": [
        "TASK-008"
      ],
      "docs_updated": false
    },
    {
      "id": "TASK-008",
      "title": "Automated Embedding Sync",
      "status": "pending",
      "priority": "high",
      "category": "feature",
      "created": "2026-01-17",
      "updated": "2026-01-17",
      "assigned_agent": "pending",
      "requires_review": false,
      "reviewed_by": null,
      "review_notes": null,
      "description": "Integrate vector store population into the main pipeline to ensure local embeddings are always up to date with the graph.",
      "acceptance_criteria": [
        "New chunks are automatically vectorized and added to ChromaDB",
        "Avoid redundant API calls for existing chunks",
        "Unified processing command (e.g., python src/main_pipeline.py --sync-vectors)"
      ],
      "subtasks": [],
      "blocked_by": [
        "TASK-007"
      ],
      "blocks": [],
      "docs_updated": false
    },
    {
      "id": "TASK-009",
      "title": "Resource & Performance Profiling",
      "status": "pending",
      "priority": "medium",
      "category": "infrastructure",
      "created": "2026-01-17",
      "updated": "2026-01-17",
      "assigned_agent": "pending",
      "requires_review": false,
      "reviewed_by": null,
      "review_notes": null,
      "description": "Measure and optimize RAM and CPU usage to ensure the system runs stable on a 4GB VPS.",
      "acceptance_criteria": [
        "Memory profiling for NetworkX graph loading",
        "Optimization of ChromaDB memory footprint",
        "Stable API performance under concurrent requests"
      ],
      "subtasks": [],
      "blocked_by": [
        "TASK-008"
      ],
      "blocks": [],
      "docs_updated": false
    },
    {
      "id": "TASK-010",
      "title": "Phase 1 Graph RAG: BM25 + RRF + Reranking",
      "status": "completed",
      "priority": "critical",
      "category": "feature",
      "created": "2026-01-17",
      "updated": "2026-01-17",
      "assigned_agent": "opencode",
      "requires_review": true,
      "reviewed_by": null,
      "review_notes": "Implemented BM25 sparse retrieval, RRF fusion, and cross-encoder reranking. New /api/search/advanced endpoint created.",
      "description": "Implement State-of-the-Art Graph RAG Phase 1: Hybrid retrieval with BM25 sparse retrieval, Reciprocal Rank Fusion, and Cross-Encoder reranking for German legal text.",
      "acceptance_criteria": [
        "BM25Index with SpaCy tokenization implemented",
        "Reranker with mmarco-mMiniLM-L12 model",
        "RRF fusion for combining BM25 + Vector results",
        "search_v2() method in HybridSearchEngine",
        "/api/search/advanced endpoint with feature flags",
        "Backward compatible with existing /api/search",
        "Documentation updated (PRD, requirements.txt)"
      ],
      "subtasks": [
        "Create src/parser/bm25_index.py",
        "Create src/parser/reranker.py",
        "Add RRF fusion to HybridSearchEngine",
        "Create search_v2() method",
        "Update API with /api/search/advanced",
        "Update requirements.txt",
        "Update PRD.md and tasks.json"
      ],
      "blocked_by": [],
      "blocks": [
        "TASK-011"
      ],
      "docs_updated": true,
      "verified": true,
      "verified_by": "opencode",
      "verified_date": "2026-01-17",
      "files_changed": [
        "src/parser/bm25_index.py (NEW)",
        "src/parser/reranker.py (NEW)",
        "src/parser/hybrid_search.py (MODIFIED)",
        "src/api/search_api.py (MODIFIED)",
        "requirements.txt (MODIFIED)",
        "PRD.md (MODIFIED)",
        ".opencode/tasks.json (MODIFIED)"
      ],
      "estimated_impact": {
        "hit_at_10": "+7% (75% → 82%)",
        "mrr": "+0.08 (0.55 → 0.63)",
        "recall": "+25% for keyword queries",
        "memory": "+170MB peak",
        "latency": "+700ms for advanced search"
      }
    },
    {
      "id": "TASK-011",
      "title": "Phase 2 Graph RAG: Personalized PageRank & Graph Algorithms",
      "status": "completed",
      "priority": "high",
      "category": "feature",
      "created": "2026-01-17",
      "updated": "2026-01-17",
      "assigned_agent": "Antigravity",
      "requires_review": true,
      "reviewed_by": null,
      "review_notes": "Implemented Personalized PageRank, smart k-hop expansion, temporal filtering, and centrality-based scoring. Integrated into search_v2().",
      "description": "Implement advanced graph algorithms: Personalized PageRank for subgraph extraction, smart k-hop expansion with temporal filtering, and centrality-based scoring.",
      "acceptance_criteria": [
        "GraphAlgorithms class with PPR implementation",
        "Smart k-hop expansion with edge filtering",
        "Temporal filtering (SUPERSEDES chain)",
        "Replace degree-based scoring with PageRank centrality",
        "Integration into search_v2()"
      ],
      "subtasks": [
        "Create src/graph/graph_algorithms.py",
        "Implement PPR and subgraph extraction",
        "Implement smart k-hop expansion",
        "Implement temporal filter for SUPERSEDES",
        "Integrate into HybridSearchEngine"
      ],
      "blocked_by": [
        "TASK-010"
      ],
      "blocks": [
        "TASK-012"
      ],
      "docs_updated": true,
      "verified": true,
      "verified_by": "Antigravity",
      "verified_date": "2026-01-17",
      "files_changed": [
        "src/graph/graph_algorithms.py (NEW)",
        "src/parser/hybrid_search.py (MODIFIED)",
        "tests/test_phase2.py (NEW)"
      ]
    },
    {
      "id": "TASK-012",
      "title": "Phase 3 Graph RAG: Query Enhancement",
      "status": "pending",
      "priority": "medium",
      "category": "feature",
      "created": "2026-01-17",
      "updated": "2026-01-17",
      "assigned_agent": "pending",
      "requires_review": false,
      "reviewed_by": null,
      "review_notes": null,
      "description": "Implement query enhancement techniques: Multi-query generation, HyDE (Hypothetical Document Embeddings), and query decomposition.",
      "acceptance_criteria": [
        "QueryEnhancer class with multi-query support",
        "HyDE generation for legal terminology",
        "Query decomposition for complex questions",
        "Integration into search_v2()"
      ],
      "subtasks": [
        "Create src/parser/query_enhancer.py",
        "Implement multi-query generation",
        "Implement HyDE",
        "Implement query decomposition",
        "Integrate into retrieval pipeline"
      ],
      "blocked_by": [
        "TASK-011"
      ],
      "blocks": [
        "TASK-013"
      ],
      "docs_updated": false
    }
  ],
  "features": [
    {
      "id": "FEAT-001",
      "title": "Graph Density (The Brain)",
      "status": "completed",
      "version": "1.1.0",
      "created": "2026-01-10",
      "completed": "2026-01-15",
      "requires_review": false,
      "reviewed_by": "Antigravity",
      "review_notes": "Reference extraction is solid.",
      "tests": {
        "unit": "completed",
        "integration": "completed",
        "e2e": "pending"
      },
      "docs": {
        "prd_updated": true,
        "api_docs_updated": false,
        "user_guide_updated": false
      }
    },
    {
      "id": "FEAT-002",
      "title": "Local Stability & DX",
      "status": "completed",
      "version": "1.1.1",
      "created": "2026-01-12",
      "completed": "2026-01-16",
      "requires_review": false,
      "reviewed_by": "opencode",
      "review_notes": "DX improved significantly with config centralization.",
      "tests": {
        "unit": "completed",
        "integration": "completed",
        "e2e": "completed"
      },
      "docs": {
        "prd_updated": true,
        "api_docs_updated": false,
        "user_guide_updated": true
      }
    },
    {
      "id": "FEAT-003",
      "title": "Graph-Guided RAG",
      "status": "completed",
      "version": "1.1.2",
      "created": "2026-01-15",
      "completed": "2026-01-17",
      "requires_review": true,
      "reviewed_by": null,
      "review_notes": "Implemented multi-hop logic. Next agent should review integration.",
      "tests": {
        "unit": "completed",
        "integration": "completed",
        "e2e": "pending"
      },
      "docs": {
        "prd_updated": true,
        "api_docs_updated": true,
        "user_guide_updated": false
      }
    },
    {
      "id": "FEAT-004",
      "title": "State-of-the-Art Graph RAG Phase 1",
      "status": "completed",
      "version": "2.0.0",
      "created": "2026-01-17",
      "completed": "2026-01-17",
      "requires_review": true,
      "reviewed_by": null,
      "review_notes": "BM25 + RRF + Reranking pipeline implemented. Backward compatible with existing API. Performance improvements projected at +20-30%.",
      "tests": {
        "unit": "pending",
        "integration": "pending",
        "e2e": "pending"
      },
      "docs": {
        "prd_updated": true,
        "api_docs_updated": true,
        "user_guide_updated": false
      },
      "components": [
        "BM25Index (src/parser/bm25_index.py)",
        "Reranker (src/parser/reranker.py)",
        "RRF Fusion (_reciprocal_rank_fusion)",
        "HybridSearchEngine.search_v2()",
        "/api/search/advanced endpoint"
      ],
      "benchmarks": {
        "hit_at_10_baseline": "75%",
        "hit_at_10_projected": "82%",
        "mrr_baseline": "0.55",
        "mrr_projected": "0.63",
        "memory_increase": "+170MB",
        "latency_increase": "+700ms (advanced search)"
      }
    }
  ],
  "rules": {
    "version_increment": "Only increment version when feature is completed AND reviewed",
    "review_policy": "Reviews can only be done by NEXT agent, not same agent",
    "hallucination_prevention": [
      "Never mark tasks as completed without verification",
      "Always check if files/functions exist before referencing",
      "Update this JSON after every significant change"
    ],
    "handoff_required": [
      "Update meta.last_agent",
      "Update meta.last_updated",
      "Mark completed tasks",
      "Set requires_review for next agent"
    ]
  }
}
